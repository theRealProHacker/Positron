# CSS Modules

If you open a webbrowser and open a simple website with no style, every element will have a style dict with all possible css properties. This is pretty memory inefficient. The modern solution is style sharing, which is already implemented in Positron. The idea is that Elements that have identical styles, shouldn't each hold a seperate copy, but instead they can just reference the same object and therefore save huge amounts of memory. Thousands of elements could have the axact same style applied. 

> Note: This is implemented with `own_types.FrozenDCache`

However, there is another thing. In our current implementation a lot of styling is saved, that might never actually be used. There might be a solution to that "problem". What I am thinking of is disabling and enabling so-called `CSS Modules`. These would group properties that provide related functionalities. An example could be a `Module` called `ScrollBar` which might contain the properties `scrollbar-width` and `scrollbar-color`. Most applications might never use them because they are just not interested in styling the scrollbar. So it would be a huge waste to save the scrollbar style. So you could disable that `Module` by default and only enable it when needed. 

There is another solution that I really like, but am totally unsure about implementing it. There should be some kind of `Style` object that contains an incomplete style. Only the document root always has a complete style. Then if a css-property of element x is requested, the `Style` either asks the parent (inherited properties) or it just returns the default value (non-inherited properties). That however could lead to performance issues because for many properties every single element would climb up its parent chain until it reaches the root for every property. This could be solved with caching, but then we are in the orginal situation, where every element just has a complete style.

For that reason, I really like the idea of these CSS-Modules. You can cherry pick exactly what you like. If you however don't want to manually select your modules, Positron should automatically enable modules from the contents of your stylesheets. So that for example loading in extern css libraries should be very simple. 

To get back to the scrollbar example: If the CSS-Parser or preprocessor finds a property that is not yet enabled, it automatically enables the related Module glabally. Still, implementations using modularized properties should always use `get` with a default value to make sure, there are no `KeyErrors`. In the above example the scrollbar implementation could call something like `style.get("scrollbar-width", Length(5))` which would get the saved scrollbar-width, but resolves to the default value of 5 pixels if it is not in the style. 